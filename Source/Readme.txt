Refactored source code here.

Old SRC will be deprecated later.
